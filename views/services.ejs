<% layout("/layouts/boilerplate")%>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aluminum Properties Dashboard</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <style>
      .dashboard-container {
        margin-top: 20px;
      }
      .card-title {
        font-size: 1.5rem;
        font-weight: bold;
      }
      .form-range {
        width: 100%;
      }
      .output-value {
        font-weight: bold;
        font-size: 1.25rem;
        color: #2c3e50;
      }
      .btn-primary {
        margin-top: 20px;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="container-fluid dashboard-container">
      <div class="row">
        <!-- Input Parameters Section -->
        <div class="col-md-4">
          <div class="card mb-4">
            <div class="card-body">
              <h5 class="card-title">Input Parameters</h5>

              <!-- Aluminum Percentage -->
              <div class="mb-3">
                <label for="aluminum">Aluminum %</label>
                <input
                  type="range"
                  class="form-range"
                  id="aluminum"
                  min="0"
                  max="100"
                  value="95"
                  oninput="updateValue('aluminum-value', this.value)"
                />
                <p>Selected: <span id="aluminum-value">95</span>%</p>
              </div>

              <!-- Temperature -->
              <div class="mb-3">
                <label for="temperature">Temperature (°C)</label>
                <input
                  type="range"
                  class="form-range"
                  id="temperature"
                  min="0"
                  max="1000"
                  value="500"
                  oninput="updateValue('temperature-value', this.value)"
                />
                <p>Selected: <span id="temperature-value">500</span> °C</p>
              </div>

              <!-- Magnesium Percentage -->
              <div class="mb-3">
                <label for="magnesium">Magnesium %</label>
                <input
                  type="range"
                  class="form-range"
                  id="magnesium"
                  min="0"
                  max="100"
                  value="5"
                  oninput="updateValue('magnesium-value', this.value)"
                />
                <p>Selected: <span id="magnesium-value">5</span>%</p>
              </div>

              <!-- Silicon Percentage -->
              <div class="mb-3">
                <label for="silicon">Silicon %</label>
                <input
                  type="range"
                  class="form-range"
                  id="silicon"
                  min="0"
                  max="100"
                  value="2"
                  oninput="updateValue('silicon-value', this.value)"
                />
                <p>Selected: <span id="silicon-value">2</span>%</p>
              </div>

              <!-- Zinc Percentage -->
              <div class="mb-3">
                <label for="zinc">Zinc %</label>
                <input
                  type="range"
                  class="form-range"
                  id="zinc"
                  min="0"
                  max="100"
                  value="1"
                  oninput="updateValue('zinc-value', this.value)"
                />
                <p>Selected: <span id="zinc-value">1</span>%</p>
              </div>

              <!-- Rolling Speed -->
              <div class="mb-3">
                <label for="rolling-speed">Rolling Speed (m/s)</label>
                <input
                  type="range"
                  class="form-range"
                  id="rolling-speed"
                  min="0"
                  max="50"
                  value="25"
                  oninput="updateValue('rolling-speed-value', this.value)"
                />
                <p>Selected: <span id="rolling-speed-value">25</span> m/s</p>
              </div>

              <!-- Heat Treatment (Yes/No) -->
              <div class="mb-3">
                <label for="heat-treatment">Heat Treatment</label>
                <select id="heat-treatment" class="form-select">
                  <option value="yes">Yes</option>
                  <option value="no">No</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- Output Predictions Section -->
        <div class="col-md-8">
          <div class="card mb-4">
            <div class="card-body">
              <h5 class="card-title">Predicted Properties</h5>

              <div class="mb-3">
                <p>
                  <strong>Tensile Strength:</strong>
                  <span id="tensile-strength" class="output-value">-</span> MPa
                </p>
                <p>
                  <strong>Yield Strength:</strong>
                  <span id="yield-strength" class="output-value">-</span> MPa
                </p>
                <p>
                  <strong>Elongation:</strong>
                  <span id="elongation" class="output-value">-</span> %
                </p>
              </div>

              <!-- Button to trigger prediction -->
              <button class="btn btn-primary" onclick="getPredictions()">
                Get Predictions
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- JavaScript to handle input updates -->
    <script>
      function updateValue(id, value) {
        document.getElementById(id).textContent = value;
      }

      function getPredictions() {
        // Get the values from the input fields
        const aluminum = document.getElementById("aluminum").value;
        const temperature = document.getElementById("temperature").value;
        const magnesium = document.getElementById("magnesium").value;
        const silicon = document.getElementById("silicon").value;
        const zinc = document.getElementById("zinc").value;
        const rollingSpeed = document.getElementById("rolling-speed").value;
        const heatTreatment = document.getElementById("heat-treatment").value;

        // Send the data to the backend
        fetch("/predict", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            aluminum,
            temperature,
            magnesium,
            silicon,
            zinc,
            rollingSpeed,
            heatTreatment,
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            // Update the prediction fields
            document.getElementById("tensile-strength").textContent =
              data.tensile_strength;
            document.getElementById("yield-strength").textContent =
              data.yield_strength;
            document.getElementById("elongation").textContent = data.elongation;
          })
          .catch((error) => console.error("Error:", error));
      }
    </script>
  </body>
</html>
